<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMP Practice Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .header h1 {
            color: #2c5aa0;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .test-selection {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .test-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .test-btn {
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .test-btn:hover {
            background: #1e3f73;
        }

        .test-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .options {
            margin: 20px 0;
        }

        .option {
            margin: 10px 0;
        }

        .option label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .timer {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 18px;
        }

        .test-interface {
            display: none;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .test-header {
            background: #2c5aa0;
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-info {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .question-container {
            padding: 30px;
        }

        .question {
            margin-bottom: 20px;
        }

        .question h3 {
            color: #2c5aa0;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .question-text {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #2c5aa0;
        }

        .options-container {
            margin: 20px 0;
        }

        .option-item {
            margin: 10px 0;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-item:hover {
            border-color: #2c5aa0;
            background: #f0f4f8;
        }

        .option-item.selected {
            border-color: #2c5aa0;
            background: #e3f2fd;
        }

        .option-item.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }

        .option-item.incorrect {
            border-color: #e74c3c;
            background: #fdeaea;
        }

        .option-label {
            font-weight: bold;
            margin-right: 10px;
            color: #2c5aa0;
        }

        .feedback {
            display: none;
            margin: 20px 0;
            padding: 20px;
            border-radius: 6px;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
        }

        .feedback.show {
            display: block;
        }

        .feedback h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-top: 1px solid #e0e0e0;
        }

        .nav-center {
            display: flex;
            gap: 10px;
        }

        .nav-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav-btn:hover:not(:disabled) {
            background: #5a6268;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-btn.primary {
            background: #2c5aa0;
        }

        .nav-btn.primary:hover:not(:disabled) {
            background: #1e3f73;
        }

        .nav-btn.secondary {
            background: #6c757d;
            color: white;
        }

        .nav-btn.secondary:hover:not(:disabled) {
            background: #5a6268;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            background: #2c5aa0;
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 18px;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-body p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s;
            text-align: left;
        }

        .modal-btn:hover {
            background: #1e3f73;
        }

        .modal-btn.danger {
            background: #e74c3c;
        }

        .modal-btn.danger:hover {
            background: #c0392b;
        }

        .domain-progress {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .domain-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .domain-card h4 {
            color: #2c5aa0;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background: #27ae60;
            transition: width 0.3s;
        }

        .results {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .results.show {
            display: block;
        }

        .results h2 {
            color: #2c5aa0;
            text-align: center;
            margin-bottom: 30px;
        }

        .score-summary {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .score-number {
            font-size: 48px;
            font-weight: bold;
            color: #2c5aa0;
        }

        .score-percentage {
            font-size: 24px;
            color: #666;
            margin-top: 10px;
        }

        .domain-results {
            margin: 30px 0;
        }

        .domain-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .recommendations {
            margin: 30px 0;
            padding: 20px;
            background: #e8f4fd;
            border-radius: 6px;
            border-left: 4px solid #2c5aa0;
        }

        .restart-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: block;
            margin: 20px auto;
        }

        .restart-btn:hover {
            background: #219a52;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .test-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation {
                flex-direction: column;
                gap: 15px;
            }

            .nav-center {
                order: 1;
            }

            .nav-options {
                order: 2;
            }
            
            .progress-info {
                flex-direction: column;
                gap: 10px;
            }

            .modal-content {
                margin: 20px;
                width: calc(100% - 40px);
            }

            .modal-buttons {
                gap: 8px;
            }

            .modal-btn {
                padding: 10px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PMP Practice Test</h1>
            <p>Project Management Professional Certification Practice Exam</p>
            <p>180 Questions ‚Ä¢ 3 Test Versions Available ‚Ä¢ Domain-Based Scoring</p>
        </div>

        <div id="testSelection" class="test-selection">
            <h2>Select Your Practice Test</h2>
            <p>Choose from three different test versions, each with unique questions covering the same PMP concepts.</p>
            
            <div class="test-buttons">
                <button class="test-btn" onclick="startTest(1)">Test Version A</button>
                <button class="test-btn" onclick="startTest(2)">Test Version B</button>
                <button class="test-btn" onclick="startTest(3)">Test Version C</button>
            </div>

            <div class="options">
                <div class="option">
                    <label>
                        <input type="checkbox" id="timerEnabled" checked>
                        Enable Timer (230 minutes)
                    </label>
                </div>
                <div class="option">
                    <label>
                        <input type="checkbox" id="immediateSubmitFeedback" checked>
                        Show immediate feedback on incorrect answers
                    </label>
                </div>
            </div>

            <div class="domain-progress">
                <div class="domain-card">
                    <h4>Domain I: People (42%)</h4>
                    <p>76 questions covering team leadership, conflict resolution, and stakeholder engagement</p>
                </div>
                <div class="domain-card">
                    <h4>Domain II: Process (50%)</h4>
                    <p>90 questions covering project planning, execution, and monitoring</p>
                </div>
                <div class="domain-card">
                    <h4>Domain III: Business Environment (8%)</h4>
                    <p>14 questions covering compliance, business value, and organizational change</p>
                </div>
            </div>
        </div>

        <div id="testInterface" class="test-interface">
            <div class="test-header">
                <div class="progress-info">
                    <span id="questionProgress">Question 1 of 180</span>
                    <span id="domainInfo">Domain I: People</span>
                </div>
                <div class="timer-controls">
                    <div id="timer" class="timer">230:00</div>
                </div>
            </div>

            <div class="question-container">
                <div class="question">
                    <h3 id="questionTitle">Question 1</h3>
                    <div id="questionText" class="question-text"></div>
                    <div id="optionsContainer" class="options-container"></div>
                    <div id="feedback" class="feedback">
                        <h4>Explanation</h4>
                        <p id="feedbackText"></p>
                    </div>
                </div>
            </div>

            <div class="navigation">
                <button id="prevBtn" class="nav-btn" onclick="previousQuestion()" disabled>Previous</button>
                <div class="nav-center">
                    <button id="submitBtn" class="nav-btn primary" onclick="submitAnswer()">Submit Answer</button>
                    <button id="nextBtn" class="nav-btn" onclick="nextQuestion()" disabled>Next</button>
                </div>
                <div class="nav-options">
                    <button class="nav-btn secondary" onclick="showTestOptions()">Options</button>
                    <button id="finishBtn" class="nav-btn primary" onclick="finishTest()" style="display: none;">Finish Test</button>
                </div>
            </div>
            
            <!-- Test Options Modal -->
            <div id="testOptionsModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Test Options</h3>
                        <button class="close-btn" onclick="hideTestOptions()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>What would you like to do?</p>
                        <div class="modal-buttons">
                            <button class="modal-btn" onclick="returnToHome()">
                                üè† Return to Home Page
                            </button>
                            <button class="modal-btn danger" onclick="confirmResetTest()">
                                üîÑ Reset Current Test
                            </button>
                            <button class="modal-btn" onclick="hideTestOptions()">
                                ‚Ü©Ô∏è Continue Test
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Reset Confirmation Modal -->
            <div id="resetConfirmModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Confirm Reset</h3>
                    </div>
                    <div class="modal-body">
                        <p><strong>‚ö†Ô∏è Warning:</strong> This will reset your current test progress and return you to the home page. All your answers will be lost.</p>
                        <p>Are you sure you want to continue?</p>
                        <div class="modal-buttons">
                            <button class="modal-btn danger" onclick="resetTest()">
                                Yes, Reset Test
                            </button>
                            <button class="modal-btn" onclick="hideResetConfirm()">
                                No, Continue Test
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="results" class="results">
            <h2>Test Results</h2>
            <div class="score-summary">
                <div id="scoreNumber" class="score-number">0</div>
                <div class="score-percentage">
                    <span id="scorePercentage">0%</span> Correct
                    <div>(<span id="correctCount">0</span> out of 180 questions)</div>
                </div>
            </div>

            <div class="domain-results">
                <h3>Performance by Domain</h3>
                <div id="domainResults"></div>
            </div>

            <div id="recommendations" class="recommendations">
                <h4>Study Recommendations</h4>
                <div id="recommendationText"></div>
            </div>

            <button class="restart-btn" onclick="restartTest()">Take Another Test</button>
        </div>
    </div>

    <script>
        // Test data structure - original questions rewritten to avoid copyright
        const testQuestions = {
            1: [ // Test Version A
                {
                    id: "people_001",
                    domain: "I.6",
                    domainName: "People",
                    question: "A project manager takes over a team where members frequently disagree on technical approaches and show little respect for each other's contributions. After implementing new leadership practices, the team begins communicating better and establishing collaborative procedures. What team development stage has the team reached?",
                    options: ["Forming", "Storming", "Norming", "Performing"],
                    correct: 2,
                    feedback: "The norming stage is characterized by team members developing mutual respect, establishing working procedures, and beginning to collaborate effectively. This follows the initial forming and storming phases."
                },
                {
                    id: "people_002",
                    domain: "I.6",
                    domainName: "People",
                    question: "Three interdependent project teams are working on separate components that must integrate seamlessly. The team lead is concerned about potential integration conflicts. What should the project manager recommend?",
                    options: [
                        "Establish regular coordination meetings between all three teams to proactively identify and address potential conflicts",
                        "Prioritize one team's work and delay the others to eliminate any possibility of conflicts",
                        "Wait for conflicts to emerge and document them as they occur for future resolution",
                        "Allow all teams to continue independently and address integration issues during final testing"
                    ],
                    correct: 0,
                    feedback: "Proactive communication and coordination between interdependent teams is essential for identifying potential conflicts early and maintaining project integration. Regular cross-team meetings facilitate this coordination."
                },
                {
                    id: "process_001",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $150,000 budget should be 80% complete but is only 60% complete. The actual cost spent is $95,000. Calculate the Schedule Performance Index (SPI) and Cost Performance Index (CPI).",
                    options: [
                        "SPI = 0.75, CPI = 0.95",
                        "SPI = 1.33, CPI = 1.05",
                        "SPI = 0.80, CPI = 1.20",
                        "SPI = 0.90, CPI = 0.85"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 60% √ó $150,000 = $90,000. Planned Value = 80% √ó $150,000 = $120,000. SPI = EV/PV = $90,000/$120,000 = 0.75. CPI = EV/AC = $90,000/$95,000 = 0.95. Values less than 1.0 indicate behind schedule and over budget."
                },
                {
                    id: "business_001",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "New regulatory requirements are expected to be enacted within 4 months that will affect your product. Your project will complete in 2 months, but the product may not comply with the new regulations. How should you proceed?",
                    options: [
                        "Meet with stakeholders to assess risks, update assumptions, and potentially revise the project charter based on regulatory impact",
                        "Continue with the current plan and address compliance after the regulations are finalized",
                        "Complete the project quickly to avoid being subject to the new regulations",
                        "Postpone the project until the new regulations are clearly defined"
                    ],
                    correct: 0,
                    feedback: "Regulatory changes represent significant project risks that require immediate stakeholder consultation, risk assessment, and potential scope or timeline adjustments to ensure compliance."
                },
                {
                    id: "people_003",
                    domain: "I.12",
                    domainName: "People",
                    question: "Stakeholders are not participating consistently in requirements gathering sessions, making it difficult to identify project constraints and assumptions. What are two effective approaches to improve stakeholder engagement? (Choose TWO)",
                    options: ["Apply political awareness techniques", "Practice servant leadership", "Use time-boxed sessions", "Employ effective facilitation methods"],
                    correct: [1, 3],
                    multiSelect: true,
                    feedback: "Servant leadership focuses on serving stakeholders' needs and removing barriers to their participation. Effective facilitation ensures productive meetings where all stakeholders can contribute meaningfully to decision-making."
                },
                {
                    id: "process_002",
                    domain: "II.3",
                    domainName: "Process",
                    question: "Your team has identified four risks with the following probability and impact ratings (scale 1-5): Risk A (Prob: 2, Impact: 5), Risk B (Prob: 4, Impact: 3), Risk C (Prob: 3, Impact: 4), Risk D (Prob: 1, Impact: 3). How should these risks be prioritized?",
                    options: ["B, C, A, D", "C, B, A, D", "A, B, C, D", "D, A, B, C"],
                    correct: 0,
                    feedback: "Risk priority is determined by multiplying probability √ó impact. Risk B: 4√ó3=12, Risk C: 3√ó4=12, Risk A: 2√ó5=10, Risk D: 1√ó3=3. Risks B and C tie for highest priority, followed by A, then D."
                },
                {
                    id: "business_002",
                    domain: "III.3",
                    domainName: "Business Environment",
                    question: "Your company is losing market share to competitors with innovative business models. An agile team is formed to recommend recovery strategies. What approach will most likely produce successful recommendations?",
                    options: [
                        "Analyze why customers are dissatisfied with current products",
                        "Focus on developing unique, high-quality innovative products",
                        "Study how competitors reach more customers at lower costs",
                        "Understand the value customers seek and what competitors provide"
                    ],
                    correct: 3,
                    feedback: "Understanding customer value expectations and competitive value propositions provides the foundation for developing effective market recovery strategies. This aligns with agile principles of customer focus and value delivery."
                },
                {
                    id: "people_004",
                    domain: "I.4",
                    domainName: "People",
                    question: "A team member consistently delivers work late, causing delays to dependent tasks. The team member claims they need extra time for quality assurance. How should the project manager address this situation?",
                    options: [
                        "Accept the delays as necessary for quality",
                        "Coach the team member on estimation and time management techniques",
                        "Reassign the team member to less critical tasks",
                        "Document the performance issues for their supervisor"
                    ],
                    correct: 1,
                    feedback: "Coaching helps develop the team member's skills in estimation and time management while addressing the root cause of delays. This servant leadership approach empowers the individual to improve performance."
                },
                {
                    id: "process_003",
                    domain: "II.7",
                    domainName: "Process",
                    question: "Four deliverables have failed to meet quality requirements specified in your quality management plan. What should be your first step?",
                    options: [
                        "Revise the quality management plan to match current performance",
                        "Request additional resources from the sponsor",
                        "Conduct root cause analysis using appropriate quality tools",
                        "Escalate the quality issues to the project sponsor"
                    ],
                    correct: 2,
                    feedback: "Root cause analysis helps identify the underlying reasons for quality failures, enabling the team to implement effective corrective actions rather than just treating symptoms."
                },
                {
                    id: "people_005",
                    domain: "I.11",
                    domainName: "People",
                    question: "A virtual team member has been absent from daily standups for a week following a natural disaster in their region, impacting the critical path. How should the project manager respond?",
                    options: [
                        "Replace the team member immediately with available resources",
                        "Contact the team member's functional manager to handle the situation",
                        "Obtain temporary resources to cover the work while checking on the team member's situation",
                        "Ask other team members to contact the missing person"
                    ],
                    correct: 2,
                    feedback: "In crisis situations, the project manager should show empathy while maintaining project progress. Securing temporary coverage addresses immediate project needs while allowing time to understand the team member's circumstances."
                },
                // Generate additional questions to reach 180 total
                ...generateDemoQuestions("A", 170)
            ],
            2: [ // Test Version B
                {
                    id: "people_006",
                    domain: "I.6",
                    domainName: "People",
                    question: "During project initiation, team members are getting acquainted, expressing enthusiasm about the project, but haven't received detailed project information yet. What team development stage is this?",
                    options: ["Storming", "Norming", "Forming", "Performing"],
                    correct: 2,
                    feedback: "The forming stage occurs when team members first meet and learn about the project. Members are typically polite, positive, and focused on understanding their roles and the project objectives."
                },
                {
                    id: "people_007", 
                    domain: "I.6",
                    domainName: "People",
                    question: "Multiple project teams are developing highly interdependent components. The team lead wants to prevent integration conflicts. What guidance should the project manager provide?",
                    options: [
                        "Schedule weekly coordination meetings to monitor progress and identify potential conflicts early",
                        "Sequence the teams' work to eliminate dependencies and potential conflicts",
                        "Create a conflict log to document issues as they arise during development",
                        "Plan to resolve all conflicts during the integration and testing phase"
                    ],
                    correct: 0,
                    feedback: "Early identification and prevention of conflicts through regular coordination is more effective than reactive conflict resolution. Proactive monitoring enables teams to adjust their work before conflicts become critical issues."
                },
                {
                    id: "process_004",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $200,000 budget should be 75% complete but shows only 65% completion. Actual costs are $140,000. What are the SPI and CPI values?",
                    options: [
                        "SPI = 0.87, CPI = 0.93",
                        "SPI = 1.15, CPI = 1.07",
                        "SPI = 0.93, CPI = 0.87",
                        "SPI = 1.07, CPI = 1.15"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 65% √ó $200,000 = $130,000. Planned Value = 75% √ó $200,000 = $150,000. SPI = $130,000/$150,000 = 0.87. CPI = $130,000/$140,000 = 0.93. Both values below 1.0 indicate schedule delays and cost overruns."
                },
                {
                    id: "business_003",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "Shortly after project charter approval, the team learns of new international compliance requirements that may affect the project's business case. What should the project manager do first?",
                    options: [
                        "Research the requirements thoroughly and provide recommendations to the sponsor",
                        "Update the quality management plan to address compliance requirements",
                        "Continue as planned since the requirement wasn't in the original scope",
                        "Add the requirement to the risk register and seek stakeholder guidance"
                    ],
                    correct: 0,
                    feedback: "The project manager should research and understand the compliance requirements and their potential impact before recommending appropriate actions to the sponsor and stakeholders."
                },
                // Add more Version B questions
                ...generateDemoQuestions("B", 176)
            ],
            3: [ // Test Version C
                {
                    id: "people_008",
                    domain: "I.10",
                    domainName: "People",
                    question: "A newly formed project team includes both employees and contractors. During the kickoff meeting, team members argue about project goals and detailed requirements. What action will help build shared understanding?",
                    options: [
                        "Separate team members by expertise and assign specific work areas",
                        "Establish a hierarchical structure with clear authority levels",
                        "Have the product owner facilitate discussions and clarify project objectives",
                        "Pair employees with contractors for better knowledge transfer"
                    ],
                    correct: 2,
                    feedback: "When teams are in the storming phase with disagreements, having the product owner provide clarity on objectives and facilitate collaborative discussions helps the team move toward shared understanding and common goals."
                },
                {
                    id: "people_009",
                    domain: "I.6",
                    domainName: "People",
                    question: "A senior stakeholder bypasses the product owner and directly assigns urgent work to the agile team. During sprint reviews, the product owner becomes upset about this unauthorized work. How should the team address this?",
                    options: [
                        "Escalate to prevent the stakeholder from interfering with the team",
                        "Establish a working agreement between the stakeholder and product owner for handling urgent requests",
                        "Require the stakeholder to submit formal change requests for new work",
                        "Allow the stakeholder to add items directly to the product backlog"
                    ],
                    correct: 1,
                    feedback: "Creating a working agreement between the stakeholder and product owner establishes clear processes for handling urgent requests while maintaining proper agile governance and team focus."
                },
                {
                    id: "process_005",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $180,000 budget should be 85% complete but is only 70% complete. Actual expenditure is $135,000. Calculate the SPI and CPI.",
                    options: [
                        "SPI = 0.82, CPI = 0.93",
                        "SPI = 1.21, CPI = 1.07",
                        "SPI = 0.93, CPI = 0.82",
                        "SPI = 1.07, CPI = 1.21"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 70% √ó $180,000 = $126,000. Planned Value = 85% √ó $180,000 = $153,000. SPI = $126,000/$153,000 = 0.82. CPI = $126,000/$135,000 = 0.93. Both indices below 1.0 indicate performance issues."
                },
                // Add more Version C questions
                ...generateDemoQuestions("C", 176)
            ]
        };

        // Generate additional demo questions to reach 180 total per test
        function generateDemoQuestions(version, count) {
            const demoQuestions = [];
            const domains = [
                { code: "I", name: "People", tasks: ["I.1", "I.2", "I.3", "I.4", "I.5", "I.6", "I.7", "I.8", "I.9", "I.10", "I.11", "I.12", "I.13", "I.14"] },
                { code: "II", name: "Process", tasks: ["II.1", "II.2", "II.3", "II.4", "II.5", "II.6", "II.7", "II.8", "II.9", "II.10", "II.11", "II.12", "II.13", "II.14", "II.15", "II.16", "II.17"] },
                { code: "III", name: "Business Environment", tasks: ["III.1", "III.2", "III.3", "III.4"] }
            ];

            // Sample question templates for different domains - all original content
            const questionTemplates = {
                "I": [
                    {
                        question: "A team member is struggling with a new technology required for the project. What is the best approach to address this situation?",
                        options: ["Provide targeted training and mentoring", "Reassign the team member to different tasks", "Hire an external consultant", "Document the skill gap as a risk"],
                        correct: 0,
                        feedback: "Providing training and mentoring supports team member development and builds organizational capability, which is a key aspect of servant leadership."
                    },
                    {
                        question: "During a project review, stakeholders express concerns about the team's approach to problem-solving. How should the project manager respond?",
                        options: ["Defend the team's methodology", "Schedule individual meetings with each stakeholder", "Facilitate a collaborative discussion to address concerns", "Escalate to the project sponsor"],
                        correct: 2,
                        feedback: "Facilitating collaborative discussions helps build shared understanding and addresses stakeholder concerns through open communication."
                    },
                    {
                        question: "A virtual team spread across multiple time zones is experiencing communication challenges. What should the project manager implement?",
                        options: ["Require all team members to work the same hours", "Establish overlapping work hours and communication protocols", "Use only asynchronous communication methods", "Relocate team members to the same location"],
                        correct: 1,
                        feedback: "Establishing overlapping work hours and clear communication protocols accommodates global teams while ensuring effective collaboration."
                    },
                    {
                        question: "Two team members have a personality conflict that is affecting team dynamics. What is the most appropriate initial response?",
                        options: ["Separate the team members on different work streams", "Address the conflict privately with each team member first", "Ignore the conflict and hope it resolves itself", "Escalate to HR immediately"],
                        correct: 1,
                        feedback: "Addressing conflicts privately first allows the project manager to understand different perspectives and work toward resolution before taking more formal actions."
                    },
                    {
                        question: "A team is transitioning from predictive to agile methodology. Team members are resistant to the change. How should the project manager help?",
                        options: ["Mandate immediate adoption of all agile practices", "Provide training and gradual introduction of agile concepts", "Replace resistant team members", "Revert to predictive methodology"],
                        correct: 1,
                        feedback: "Gradual introduction with proper training helps team members understand the benefits of agile practices and reduces resistance to change."
                    }
                ],
                "II": [
                    {
                        question: "A vendor has delivered components that do not meet the specified quality requirements. What should be the project manager's first step?",
                        options: ["Accept the components and document lessons learned", "Review the contract terms and service level agreements", "Request immediate replacement components", "Escalate to senior management"],
                        correct: 1,
                        feedback: "Reviewing contract terms and SLAs provides the foundation for addressing vendor performance issues and determining appropriate next steps."
                    },
                    {
                        question: "The project timeline has been compressed by 25% while maintaining the same scope. What is the most appropriate response?",
                        options: ["Accept the challenge and work overtime", "Negotiate to reduce scope proportionally", "Request additional resources to meet the timeline", "Analyze options and present recommendations to stakeholders"],
                        correct: 3,
                        feedback: "Analyzing all available options (scope reduction, resource addition, schedule compression techniques) and presenting recommendations allows stakeholders to make informed decisions."
                    },
                    {
                        question: "During execution, a critical path activity is taking longer than estimated. What should the project manager do first?",
                        options: ["Crash the schedule by adding resources", "Fast-track subsequent activities", "Analyze the impact on the overall project timeline", "Update the project schedule immediately"],
                        correct: 2,
                        feedback: "Analyzing the impact helps determine the severity of the delay and informs decisions about appropriate corrective actions."
                    },
                    {
                        question: "A change request has been approved that will significantly alter the project scope. What is the next priority?",
                        options: ["Begin implementing the change immediately", "Update all relevant project documents and baselines", "Inform the team about the upcoming changes", "Assess the change's impact on budget and schedule"],
                        correct: 1,
                        feedback: "Updating project documents and baselines ensures all project artifacts remain consistent and provide accurate guidance for future work."
                    },
                    {
                        question: "Quality testing reveals multiple defects in a key deliverable just before a milestone review. What should the project manager do?",
                        options: ["Proceed with the milestone review as scheduled", "Postpone the review until all defects are fixed", "Conduct root cause analysis to understand the quality issues", "Replace the testing team"],
                        correct: 2,
                        feedback: "Root cause analysis helps identify systemic issues that led to quality problems, enabling the team to implement effective corrective and preventive actions."
                    }
                ],
                "III": [
                    {
                        question: "Market conditions have changed significantly since project initiation, potentially affecting the business value of deliverables. What should the project manager do?",
                        options: ["Continue with the original plan", "Conduct a business case review with stakeholders", "Immediately stop the project", "Modify deliverables based on new conditions"],
                        correct: 1,
                        feedback: "Conducting a business case review with stakeholders ensures that the project continues to deliver value under changed market conditions."
                    },
                    {
                        question: "New industry regulations will affect your project deliverables. The regulations take effect after your planned completion date. How should you proceed?",
                        options: ["Complete the project as planned before regulations take effect", "Immediately incorporate the new regulatory requirements", "Assess the impact and develop a compliance strategy", "Request a project extension to address regulations"],
                        correct: 2,
                        feedback: "Assessing regulatory impact and developing a compliance strategy ensures the deliverables will remain viable and compliant when deployed."
                    },
                    {
                        question: "The organization is undergoing a major restructure that may affect project sponsorship and funding. What should the project manager do?",
                        options: ["Continue the project without changes", "Pause the project until the restructure is complete", "Engage with new leadership to confirm project alignment", "Accelerate project completion before changes take effect"],
                        correct: 2,
                        feedback: "Engaging with new leadership ensures continued project support and alignment with organizational priorities after restructuring."
                    },
                    {
                        question: "Customer feedback indicates that a delivered feature provides limited business value despite meeting technical requirements. How should this be addressed?",
                        options: ["Defend the technical implementation", "Gather additional customer requirements for future releases", "Analyze the gap between customer expectations and delivered value", "Remove the feature from the product"],
                        correct: 2,
                        feedback: "Analyzing the value gap helps understand why the feature didn't meet business expectations and informs improvements for future deliverables."
                    },
                    {
                        question: "A competitor has launched a similar product that may reduce demand for your project's deliverables. What should the project manager recommend?",
                        options: ["Accelerate project completion to beat the competition", "Cancel the project to avoid losses", "Analyze competitive positioning and adjust project value proposition", "Continue as planned without changes"],
                        correct: 2,
                        feedback: "Analyzing competitive positioning helps determine how to differentiate the project deliverables and maintain business value in the changed market landscape."
                    }
                ]
            };

            let questionIndex = 0;
            
            // Calculate questions per domain based on PMP weights
            const peopleQuestions = Math.floor(count * 0.42); // 42%
            const processQuestions = Math.floor(count * 0.50); // 50%
            const businessQuestions = count - peopleQuestions - processQuestions; // Remaining 8%

            const domainCounts = {
                "I": peopleQuestions,
                "II": processQuestions,
                "III": businessQuestions
            };

            Object.keys(domainCounts).forEach(domainCode => {
                const domain = domains.find(d => d.code === domainCode);
                const questionCount = domainCounts[domainCode];
                
                for (let i = 0; i < questionCount; i++) {
                    const taskIndex = i % domain.tasks.length;
                    const task = domain.tasks[taskIndex];
                    const templateIndex = i % questionTemplates[domainCode].length;
                    const template = questionTemplates[domainCode][templateIndex];

                    demoQuestions.push({
                        id: `${version.toLowerCase()}_${domainCode.toLowerCase()}_${i + 1}`,
                        domain: task,
                        domainName: domain.name,
                        question: `${template.question} (Version ${version})`,
                        options: template.options,
                        correct: template.correct,
                        feedback: template.feedback
                    });
                }
            });

            return demoQuestions;
        }

        // Generate the full question sets
        // (Note: In a real implementation, you would have 180 unique questions per test)
        // This is a demonstration with a smaller set that gets extended162,000 (given). SPI = EV/PV = $115,500/$147,000 = 0.785 or 0.79, CPI = EV/AC = $115,500/$162,000 = 0.71"
                },
                {
                    id: "A00092",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "The legal team informs the product owner that another company owns a patent for an innovation used in the agile team's product, which is now 75% complete. What should the product owner do to determine the appropriate way forward?",
                    options: [
                        "Work with the legal department to find markets where the patent is NOT registered.",
                        "Perform marginal economics analysis and identify minimum releasable features.",
                        "Terminate the project immediately to prevent any further sunken costs.",
                        "Continue work on the product after removing the patented component."
                    ],
                    correct: 1,
                    feedback: "A foundational assumption to release the product has become a 'show-stopper'. Marginal economic analysis determines if there is a viable way forward. Identifying minimal releasable features can mitigate the economic loss."
                }
                // Add more questions here to reach 180 total
            ]
        };

        // Generate additional questions for each test to reach 180 total
        function generateAdditionalQuestions() {
            // This would include all 269 questions distributed across the three tests
            // For demonstration, we'll use a simplified version
            const additionalQuestions = [
                // People domain questions
                {
                    id: "sample_people_1",
                    domain: "I.12",
                    domainName: "People",
                    question: "A project manager needs stakeholder involvement in order to identify strategic and operational assumptions and constraints. Unfortunately, the project manager is having difficulty obtaining consistent input due to lack of participation. In which two ways can the project manager encourage the stakeholder to participate and collaborate? (Choose TWO.)",
                    options: ["Use political awareness techniques", "Be a servant leader", "Timebox meetings", "Use effective facilitation techniques"],
                    correct: [3, 1], // Multiple correct answers
                    multiSelect: true,
                    feedback: "Facilitation is the ability to effectively guide a group event to a successful decision, solution, or conclusion. Being a servant leader also helps encourage participation."
                },
                // Process domain questions  
                {
                    id: "sample_process_1",
                    domain: "II.3",
                    domainName: "Process",
                    question: "A project sponsor is risk averse and is therefore concerned about negative impacts on the project. To help with this concern, the project team identifies four (4) project risks and then evaluates both the probability of occurrence and the impact of the risk if it occurs. The team uses a 1-5 scale (1 is the lowest and 5 is the highest). Based on the following data, in what order should the project manager rank these risks? Risk A: Probability 1, Impact 5; Risk B: Probability 4, Impact 4; Risk C: Probability 2, Impact 5; Risk D: Probability 2, Impact 2",
                    options: ["B, A, D, C", "B, C, A, D", "B, A, C, D", "C, D, A, B"],
                    correct: 1,
                    feedback: "Risk severity is calculated by multiplying probability and impact. Risk B (4√ó4=16), Risk C (2√ó5=10), Risk A (1√ó5=5), Risk D (2√ó2=4). The higher the value, the higher the risk is rated."
                },
                // Business Environment questions
                {
                    id: "sample_business_1", 
                    domain: "III.3",
                    domainName: "Business Environment",
                    question: "A company is losing market share to disruptive competitors with new business models. A cross-functional agile team has been formed to recommend ways to recover market share. How can the team increase their chance of producing successful recommendations?",
                    options: [
                        "Gain a deep understanding of why customers are disappointed by the company's products.",
                        "Focus on enabling profitable delivery of unique, high-quality, and innovative products.",
                        "Understand how the competitors' business models can reach more consumers at a lower cost.",
                        "Focus on understanding the value consumers seek and the value competitors offer."
                    ],
                    correct: 3,
                    feedback: "The first principle of the Agile Manifesto focuses on value: 'Our highest priority is to satisfy the customer through early and continuous delivery of valuable software.' Markets are driven by the value consumers attribute to the offerings."
                }
            ];

            // Distribute additional questions across the three tests to reach 180 each
            for (let testNum = 1; testNum <= 3; testNum++) {
                while (testQuestions[testNum].length < 180) {
                    // Add variations of the additional questions
                    additionalQuestions.forEach(question => {
                        if (testQuestions[testNum].length < 180) {
                            testQuestions[testNum].push({
                                ...question,
                                id: `${question.id}_v${testNum}_${testQuestions[testNum].length}`
                            });
                        }
                    });
                }
            }
        }

        // Generate the full question sets
        generateAdditionalQuestions();

        // Application state
        let currentTest = 1;
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let testStartTime = null;
        let timerInterval = null;
        let timeRemaining = 230 * 60; // 230 minutes in seconds
        let testCompleted = false;

        // Domain mappings
        const domainInfo = {
            'I': { name: 'People', weight: 0.42, questions: 76 },
            'II': { name: 'Process', weight: 0.50, questions: 90 },
            'III': { name: 'Business Environment', weight: 0.08, questions: 14 }
        };

        // Load saved progress
        function loadProgress() {
            const saved = localStorage.getItem('pmp_test_progress');
            if (saved) {
                const data = JSON.parse(saved);
                currentTest = data.currentTest || 1;
                currentQuestionIndex = data.currentQuestionIndex || 0;
                userAnswers = data.userAnswers || {};
                timeRemaining = data.timeRemaining || 230 * 60;
                
                if (data.testStartTime && !testCompleted) {
                    // Resume test
                    document.getElementById('testSelection').style.display = 'none';
                    document.getElementById('testInterface').style.display = 'block';
                    showQuestion();
                    if (document.getElementById('timerEnabled').checked) {
                        startTimer();
                    }
                }
            }
        }

        // Save progress
        function saveProgress() {
            const data = {
                currentTest,
                currentQuestionIndex,
                userAnswers,
                timeRemaining,
                testStartTime
            };
            localStorage.setItem('pmp_test_progress', JSON.stringify(data));
        }

        // Start test
        function startTest(testNumber) {
            currentTest = testNumber;
            currentQuestionIndex = 0;
            userAnswers = {};
            testStartTime = Date.now();
            timeRemaining = 230 * 60;
            testCompleted = false;

            document.getElementById('testSelection').style.display = 'none';
            document.getElementById('testInterface').style.display = 'block';
            
            showQuestion();
            
            if (document.getElementById('timerEnabled').checked) {
                startTimer();
            }
            
            saveProgress();
        }

        // Timer functions
        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                updateTimerDisplay();
                saveProgress();
                
                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    alert('Time is up! The test will now be submitted automatically.');
                    finishTest();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timer').textContent = display;
            
            // Change color as time runs low
            const timerElement = document.getElementById('timer');
            if (timeRemaining < 1800) { // Last 30 minutes
                timerElement.style.background = '#e74c3c';
            } else if (timeRemaining < 3600) { // Last hour
                timerElement.style.background = '#f39c12';
            }
        }

        // Show current question
        function showQuestion() {
            const questions = testQuestions[currentTest];
            const question = questions[currentQuestionIndex];
            
            // Update progress info
            document.getElementById('questionProgress').textContent = 
                `Question ${currentQuestionIndex + 1} of ${questions.length}`;
            
            const domainKey = question.domain.split('.')[0];
            document.getElementById('domainInfo').textContent = 
                `Domain ${domainKey}: ${question.domainName}`;
            
            // Show question
            document.getElementById('questionTitle').textContent = 
                `Question ${currentQuestionIndex + 1}`;
            document.getElementById('questionText').textContent = question.question;
            
            // Show options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option-item';
                optionDiv.onclick = () => selectOption(index);
                
                const isSelected = question.multiSelect 
                    ? (userAnswers[question.id] && userAnswers[question.id].includes(index))
                    : userAnswers[question.id] === index;
                
                if (isSelected) {
                    optionDiv.classList.add('selected');
                }
                
                optionDiv.innerHTML = `
                    <span class="option-label">${String.fromCharCode(65 + index)}.</span>
                    ${option}
                `;
                
                optionsContainer.appendChild(optionDiv);
            });
            
            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').disabled = 
                currentQuestionIndex === questions.length - 1 || !userAnswers[question.id];
            
            // Show finish button on last question
            if (currentQuestionIndex === questions.length - 1) {
                document.getElementById('finishBtn').style.display = 'block';
            } else {
                document.getElementById('finishBtn').style.display = 'none';
            }
            
            // Hide feedback initially
            document.getElementById('feedback').classList.remove('show');
            
            // Update submit button
            const submitBtn = document.getElementById('submitBtn');
            if (userAnswers[question.id] !== undefined) {
                submitBtn.textContent = 'Change Answer';
            } else {
                submitBtn.textContent = 'Submit Answer';
            }
        }

        // Select option
        function selectOption(index) {
            const questions = testQuestions[currentTest];
            const question = questions[currentQuestionIndex];
            
            if (question.multiSelect) {
                // Handle multiple selection
                if (!userAnswers[question.id]) {
                    userAnswers[question.id] = [];
                }
                
                const answers = userAnswers[question.id];
                const existingIndex = answers.indexOf(index);
                
                if (existingIndex > -1) {
                    answers.splice(existingIndex, 1);
                } else {
                    answers.push(index);
                }
                
                if (answers.length === 0) {
                    delete userAnswers[question.id];
                }
            } else {
                // Handle single selection
                userAnswers[question.id] = index;
            }
            
            showQuestion();
            saveProgress();
        }

        // Submit answer
        function submitAnswer() {
            const questions = testQuestions[currentTest];
            const question = questions[currentQuestionIndex];
            const userAnswer = userAnswers[question.id];
            
            if (userAnswer === undefined) {
                alert('Please select an answer before submitting.');
                return;
            }
            
            // Show feedback if immediate feedback is enabled and answer is incorrect
            const isCorrect = question.multiSelect 
                ? arraysEqual(userAnswer.sort(), question.correct.sort())
                : userAnswer === question.correct;
            
            if (document.getElementById('immediateSubmitFeedback').checked && !isCorrect) {
                showFeedback(question, userAnswer);
            }
            
            // Enable next button
            document.getElementById('nextBtn').disabled = false;
            
            // Update submit button
            document.getElementById('submitBtn').textContent = 'Change Answer';
            
            saveProgress();
        }

        // Show feedback
        function showFeedback(question, userAnswer) {
            const feedbackDiv = document.getElementById('feedback');
            const feedbackText = document.getElementById('feedbackText');
            
            feedbackText.textContent = question.feedback;
            feedbackDiv.classList.add('show');
            
            // Highlight correct and incorrect options
            const optionItems = document.querySelectorAll('.option-item');
            optionItems.forEach((item, index) => {
                item.classList.remove('correct', 'incorrect');
                
                if (question.multiSelect) {
                    if (question.correct.includes(index)) {
                        item.classList.add('correct');
                    } else if (userAnswer && userAnswer.includes(index)) {
                        item.classList.add('incorrect');
                    }
                } else {
                    if (index === question.correct) {
                        item.classList.add('correct');
                    } else if (index === userAnswer) {
                        item.classList.add('incorrect');
                    }
                }
            });
        }

        // Navigation functions
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
                saveProgress();
            }
        }

        function nextQuestion() {
            const questions = testQuestions[currentTest];
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
                saveProgress();
            }
        }

        // Finish test
        function finishTest() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            testCompleted = true;
            
            // Calculate results
            const results = calculateResults();
            
            // Hide test interface
            document.getElementById('testInterface').style.display = 'none';
            
            // Show results
            showResults(results);
            
            // Clear saved progress
            localStorage.removeItem('pmp_test_progress');
        }

        // Calculate results
        function calculateResults() {
            const questions = testQuestions[currentTest];
            let totalCorrect = 0;
            const domainScores = {};
            
            // Initialize domain scores
            Object.keys(domainInfo).forEach(domain => {
                domainScores[domain] = { correct: 0, total: 0 };
            });
            
            questions.forEach(question => {
                const domainKey = question.domain.split('.')[0];
                const userAnswer = userAnswers[question.id];
                
                domainScores[domainKey].total++;
                
                if (userAnswer !== undefined) {
                    const isCorrect = question.multiSelect 
                        ? arraysEqual(userAnswer.sort(), question.correct.sort())
                        : userAnswer === question.correct;
                    
                    if (isCorrect) {
                        totalCorrect++;
                        domainScores[domainKey].correct++;
                    }
                }
            });
            
            return {
                totalCorrect,
                totalQuestions: questions.length,
                percentage: Math.round((totalCorrect / questions.length) * 100),
                domainScores
            };
        }

        // Show results
        function showResults(results) {
            document.getElementById('results').classList.add('show');
            
            // Update score display
            document.getElementById('scoreNumber').textContent = results.totalCorrect;
            document.getElementById('scorePercentage').textContent = `${results.percentage}%`;
            document.getElementById('correctCount').textContent = results.totalCorrect;
            
            // Show domain results
            const domainResultsContainer = document.getElementById('domainResults');
            domainResultsContainer.innerHTML = '';
            
            Object.keys(results.domainScores).forEach(domainKey => {
                const score = results.domainScores[domainKey];
                const percentage = score.total > 0 ? Math.round((score.correct / score.total) * 100) : 0;
                
                const domainDiv = document.createElement('div');
                domainDiv.className = 'domain-result';
                domainDiv.innerHTML = `
                    <div>
                        <strong>Domain ${domainKey}: ${domainInfo[domainKey].name}</strong>
                        <div>${score.correct} of ${score.total} correct</div>
                    </div>
                    <div style="text-align: right;">
                        <strong>${percentage}%</strong>
                        <div class="progress-bar" style="width: 100px; margin-top: 5px;">
                            <div class="progress-fill" style="width: ${percentage}%; background: ${percentage >= 70 ? '#27ae60' : percentage >= 60 ? '#f39c12' : '#e74c3c'}"></div>
                        </div>
                    </div>
                `;
                domainResultsContainer.appendChild(domainDiv);
            });
            
            // Generate recommendations
            generateRecommendations(results);
        }

        // Generate study recommendations
        function generateRecommendations(results) {
            const recommendations = [];
            
            // Overall performance
            if (results.percentage >= 80) {
                recommendations.push("üéâ Excellent performance! You're well-prepared for the PMP exam.");
            } else if (results.percentage >= 70) {
                recommendations.push("‚úÖ Good performance! Review weak areas and take additional practice tests.");
            } else if (results.percentage >= 60) {
                recommendations.push("‚ö†Ô∏è Fair performance. Focus on your weak domains and study fundamental concepts.");
            } else {
                recommendations.push("üìö More study needed. Consider additional training and focus on all domains.");
            }
            
            // Domain-specific recommendations
            Object.keys(results.domainScores).forEach(domainKey => {
                const score = results.domainScores[domainKey];
                const percentage = score.total > 0 ? (score.correct / score.total) * 100 : 0;
                
                if (percentage < 70) {
                    const domainName = domainInfo[domainKey].name;
                    switch(domainKey) {
                        case 'I':
                            recommendations.push(`üë• ${domainName}: Focus on team leadership, conflict resolution, and stakeholder engagement. Practice servant leadership scenarios.`);
                            break;
                        case 'II':
                            recommendations.push(`‚öôÔ∏è ${domainName}: Review project planning, execution, monitoring, and control processes. Study earned value management and risk management.`);
                            break;
                        case 'III':
                            recommendations.push(`üè¢ ${domainName}: Study compliance requirements, business value delivery, and organizational change management.`);
                            break;
                    }
                }
            });
            
            // Study resources
            recommendations.push("üìñ Recommended study materials: PMBOK Guide 7th Edition, Agile Practice Guide, and additional practice tests.");
            
            document.getElementById('recommendationText').innerHTML = 
                recommendations.map(rec => `<p>${rec}</p>`).join('');
        }

        // Show test options modal
        function showTestOptions() {
            document.getElementById('testOptionsModal').style.display = 'flex';
        }

        // Hide test options modal
        function hideTestOptions() {
            document.getElementById('testOptionsModal').style.display = 'none';
        }

        // Return to home page
        function returnToHome() {
            hideTestOptions();
            
            // Stop timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Save current progress before returning home
            saveProgress();
            
            // Hide test interface and show test selection
            document.getElementById('testInterface').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            document.getElementById('testSelection').style.display = 'block';
            
            // Reset timer display
            const timerElement = document.getElementById('timer');
            timerElement.textContent = '230:00';
            timerElement.style.background = '#e74c3c';
        }

        // Show reset confirmation modal
        function confirmResetTest() {
            hideTestOptions();
            document.getElementById('resetConfirmModal').style.display = 'flex';
        }

        // Hide reset confirmation modal
        function hideResetConfirm() {
            document.getElementById('resetConfirmModal').style.display = 'none';
        }

        // Reset test completely
        function resetTest() {
            hideResetConfirm();
            
            // Stop timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Reset all state
            currentTest = 1;
            currentQuestionIndex = 0;
            userAnswers = {};
            testStartTime = null;
            timeRemaining = 230 * 60;
            testCompleted = false;
            
            // Clear saved progress
            localStorage.removeItem('pmp_test_progress');
            
            // Hide test interface and results, show test selection
            document.getElementById('testInterface').style.display = 'none';
            document.getElementById('results').classList.remove('show');
            document.getElementById('testSelection').style.display = 'block';
            
            // Reset timer display
            const timerElement = document.getElementById('timer');
            timerElement.textContent = '230:00';
            timerElement.style.background = '#e74c3c';
        }

        // Utility function to compare arrays
        function arraysEqual(a, b) {
            if (a.length !== b.length) return false;
            for (let i = 0; i < a.length; i++) {
                if (a[i] !== b[i]) return false;
            }
            return true;
        }

        // Handle page visibility change (save progress when tab is hidden)
        document.addEventListener('visibilitychange', () => {
            if (document.hidden && !testCompleted) {
                saveProgress();
            }
        });

        // Handle page unload (save progress)
        window.addEventListener('beforeunload', () => {
            if (!testCompleted) {
                saveProgress();
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadProgress();
        });

        // Restart test
        function restartTest() {
            // Reset all state
            currentTest = 1;
            currentQuestionIndex = 0;
            userAnswers = {};
            testStartTime = null;
            timeRemaining = 230 * 60;
            testCompleted = false;
            
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Clear saved progress
            localStorage.removeItem('pmp_test_progress');
            
            // Hide results and show test selection
            document.getElementById('results').classList.remove('show');
            document.getElementById('testInterface').style.display = 'none';
            document.getElementById('testSelection').style.display = 'block';
            
            // Reset timer display
            document.getElementById('timer').textContent = '230:00';
            document.getElementById('timer').style.background = '#e74c3c';
        }

        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            const testOptionsModal = document.getElementById('testOptionsModal');
            const resetConfirmModal = document.getElementById('resetConfirmModal');
            
            if (e.target === testOptionsModal) {
                hideTestOptions();
            }
            if (e.target === resetConfirmModal) {
                hideResetConfirm();
            }
        });

        // Handle escape key to close modals
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                hideTestOptions();
                hideResetConfirm();
            }
            
            // Existing keyboard shortcuts for test navigation
            if (document.getElementById('testInterface').style.display === 'block' && 
                !document.getElementById('testOptionsModal').style.display.includes('flex') &&
                !document.getElementById('resetConfirmModal').style.display.includes('flex')) {
                switch(e.key) {
                    case 'ArrowLeft':
                        if (!document.getElementById('prevBtn').disabled) {
                            previousQuestion();
                        }
                        break;
                    case 'ArrowRight':
                        if (!document.getElementById('nextBtn').disabled) {
                            nextQuestion();
                        }
                        break;
                    case 'Enter':
                        if (!document.getElementById('submitBtn').disabled) {
                            submitAnswer();
                        }
                        break;
                    case '1':
                    case '2':
                    case '3':
                    case '4':
                    case '5':
                        const optionIndex = parseInt(e.key) - 1;
                        const question = testQuestions[currentTest][currentQuestionIndex];
                        if (optionIndex < question.options.length) {
                            selectOption(optionIndex);
                        }
                        break;
                }
            }
        });
    </script>
</body>
</html>
