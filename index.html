<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMP Practice Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .header h1 {
            color: #2c5aa0;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .test-selection {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        .test-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 20px 0;
        }

        .test-btn {
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .test-btn:hover {
            background: #1e3f73;
        }

        .test-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .options {
            margin: 20px 0;
        }

        .option {
            margin: 10px 0;
        }

        .option label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .timer {
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: bold;
            font-size: 18px;
        }

        .test-interface {
            display: none;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .test-header {
            background: #2c5aa0;
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-info {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .question-container {
            padding: 30px;
        }

        .question {
            margin-bottom: 20px;
        }

        .question h3 {
            color: #2c5aa0;
            margin-bottom: 15px;
            font-size: 18px;
        }

        .question-text {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #2c5aa0;
        }

        .options-container {
            margin: 20px 0;
        }

        .option-item {
            margin: 10px 0;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option-item:hover {
            border-color: #2c5aa0;
            background: #f0f4f8;
        }

        .option-item.selected {
            border-color: #2c5aa0;
            background: #e3f2fd;
        }

        .option-item.correct {
            border-color: #27ae60;
            background: #d5f4e6;
        }

        .option-item.incorrect {
            border-color: #e74c3c;
            background: #fdeaea;
        }

        .option-label {
            font-weight: bold;
            margin-right: 10px;
            color: #2c5aa0;
        }

        .feedback {
            display: none;
            margin: 20px 0;
            padding: 20px;
            border-radius: 6px;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
        }

        .feedback.show {
            display: block;
        }

        .feedback h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            border-top: 1px solid #e0e0e0;
        }

        .nav-center {
            display: flex;
            gap: 10px;
        }

        .nav-options {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .nav-btn:hover:not(:disabled) {
            background: #5a6268;
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .nav-btn.primary {
            background: #2c5aa0;
        }

        .nav-btn.primary:hover:not(:disabled) {
            background: #1e3f73;
        }

        .nav-btn.secondary {
            background: #6c757d;
            color: white;
        }

        .nav-btn.secondary:hover:not(:disabled) {
            background: #5a6268;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            background: #2c5aa0;
            color: white;
            padding: 15px 20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            margin: 0;
            font-size: 18px;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            padding: 20px;
        }

        .modal-body p {
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            background: #2c5aa0;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.3s;
            text-align: left;
        }

        .modal-btn:hover {
            background: #1e3f73;
        }

        .modal-btn.danger {
            background: #e74c3c;
        }

        .modal-btn.danger:hover {
            background: #c0392b;
        }

        .domain-progress {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .domain-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .domain-card h4 {
            color: #2c5aa0;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }

        .progress-fill {
            height: 100%;
            background: #27ae60;
            transition: width 0.3s;
        }

        .results {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .results.show {
            display: block;
        }

        .results h2 {
            color: #2c5aa0;
            text-align: center;
            margin-bottom: 30px;
        }

        .score-summary {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .score-number {
            font-size: 48px;
            font-weight: bold;
            color: #2c5aa0;
        }

        .score-percentage {
            font-size: 24px;
            color: #666;
            margin-top: 10px;
        }

        .domain-results {
            margin: 30px 0;
        }

        .domain-result {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .recommendations {
            margin: 30px 0;
            padding: 20px;
            background: #e8f4fd;
            border-radius: 6px;
            border-left: 4px solid #2c5aa0;
        }

        .restart-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            display: block;
            margin: 20px auto;
        }

        .restart-btn:hover {
            background: #219a52;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .test-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .navigation {
                flex-direction: column;
                gap: 15px;
            }

            .nav-center {
                order: 1;
            }

            .nav-options {
                order: 2;
            }
            
            .progress-info {
                flex-direction: column;
                gap: 10px;
            }

            .modal-content {
                margin: 20px;
                width: calc(100% - 40px);
            }

            .modal-buttons {
                gap: 8px;
            }

            .modal-btn {
                padding: 10px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PMP Practice Test</h1>
            <p>Project Management Professional Certification Practice Exam</p>
            <p>180 Questions ‚Ä¢ 3 Test Versions Available ‚Ä¢ Domain-Based Scoring</p>
        </div>

        <div id="testSelection" class="test-selection">
            <h2>Select Your Practice Test</h2>
            <p>Choose from three different test versions, each with unique questions covering the same PMP concepts.</p>
            
            <div class="test-buttons">
                <button class="test-btn" onclick="startTest(1)">Test Version A</button>
                <button class="test-btn" onclick="startTest(2)">Test Version B</button>
                <button class="test-btn" onclick="startTest(3)">Test Version C</button>
            </div>

            <div class="options">
                <div class="option">
                    <label>
                        <input type="checkbox" id="timerEnabled" checked>
                        Enable Timer (230 minutes)
                    </label>
                </div>
                <div class="option">
                    <label>
                        <input type="checkbox" id="immediateSubmitFeedback" checked>
                        Show immediate feedback on incorrect answers
                    </label>
                </div>
            </div>

            <div class="domain-progress">
                <div class="domain-card">
                    <h4>Domain I: People (42%)</h4>
                    <p>76 questions covering team leadership, conflict resolution, and stakeholder engagement</p>
                </div>
                <div class="domain-card">
                    <h4>Domain II: Process (50%)</h4>
                    <p>90 questions covering project planning, execution, and monitoring</p>
                </div>
                <div class="domain-card">
                    <h4>Domain III: Business Environment (8%)</h4>
                    <p>14 questions covering compliance, business value, and organizational change</p>
                </div>
            </div>
        </div>

        <div id="testInterface" class="test-interface">
            <div class="test-header">
                <div class="progress-info">
                    <span id="questionProgress">Question 1 of 180</span>
                    <span id="domainInfo">Domain I: People</span>
                </div>
                <div class="timer-controls">
                    <div id="timer" class="timer">230:00</div>
                </div>
            </div>

            <div class="question-container">
                <div class="question">
                    <h3 id="questionTitle">Question 1</h3>
                    <div id="questionText" class="question-text"></div>
                    <div id="optionsContainer" class="options-container"></div>
                    <div id="feedback" class="feedback">
                        <h4>Explanation</h4>
                        <p id="feedbackText"></p>
                    </div>
                </div>
            </div>

            <div class="navigation">
                <button id="prevBtn" class="nav-btn" onclick="previousQuestion()" disabled>Previous</button>
                <div class="nav-center">
                    <button id="submitBtn" class="nav-btn primary" onclick="submitAnswer()">Submit Answer</button>
                    <button id="nextBtn" class="nav-btn" onclick="nextQuestion()" disabled>Next</button>
                </div>
                <div class="nav-options">
                    <button class="nav-btn secondary" onclick="showTestOptions()">Options</button>
                    <button id="finishBtn" class="nav-btn primary" onclick="finishTest()" style="display: none;">Finish Test</button>
                </div>
            </div>
            
            <!-- Test Options Modal -->
            <div id="testOptionsModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Test Options</h3>
                        <button class="close-btn" onclick="hideTestOptions()">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>What would you like to do?</p>
                        <div class="modal-buttons">
                            <button class="modal-btn" onclick="returnToHome()">
                                üè† Return to Home Page
                            </button>
                            <button class="modal-btn danger" onclick="confirmResetTest()">
                                üîÑ Reset Current Test
                            </button>
                            <button class="modal-btn" onclick="hideTestOptions()">
                                ‚Ü©Ô∏è Continue Test
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Reset Confirmation Modal -->
            <div id="resetConfirmModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3>Confirm Reset</h3>
                    </div>
                    <div class="modal-body">
                        <p><strong>‚ö†Ô∏è Warning:</strong> This will reset your current test progress and return you to the home page. All your answers will be lost.</p>
                        <p>Are you sure you want to continue?</p>
                        <div class="modal-buttons">
                            <button class="modal-btn danger" onclick="resetTest()">
                                Yes, Reset Test
                            </button>
                            <button class="modal-btn" onclick="hideResetConfirm()">
                                No, Continue Test
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="results" class="results">
            <h2>Test Results</h2>
            <div class="score-summary">
                <div id="scoreNumber" class="score-number">0</div>
                <div class="score-percentage">
                    <span id="scorePercentage">0%</span> Correct
                    <div>(<span id="correctCount">0</span> out of 180 questions)</div>
                </div>
            </div>

            <div class="domain-results">
                <h3>Performance by Domain</h3>
                <div id="domainResults"></div>
            </div>

            <div id="recommendations" class="recommendations">
                <h4>Study Recommendations</h4>
                <div id="recommendationText"></div>
            </div>

            <button class="restart-btn" onclick="restartTest()">Take Another Test</button>
        </div>
    </div>

    <script>
        // Test data structure - rephrased questions to avoid copyright issues
        const testQuestions = {
            1: [ // Test Version A
                {
                    id: "people_team_dev_001",
                    domain: "I.6",
                    domainName: "People",
                    question: "A new project manager takes over a team experiencing interpersonal conflicts and lack of mutual respect among members. Under the new leadership, team members start communicating better and establishing collaborative work procedures. What team development stage are they currently in?",
                    options: ["Forming", "Storming", "Norming", "Performing"],
                    correct: 2,
                    feedback: "The norming stage is when team members develop mutual respect, establish working procedures, and begin collaborating effectively. They learn to trust each other and work together."
                },
                {
                    id: "people_coordination_001",
                    domain: "I.6",
                    domainName: "People",
                    question: "A project involves three interconnected teams developing separate but highly dependent components. The team leader is concerned about potential integration conflicts when combining outputs. What should the project manager recommend?",
                    options: [
                        "Set up regular coordination meetings between all teams to proactively identify and manage potential conflicts",
                        "Prioritize one team's deliverables and delay the others to prevent any conflicts from occurring",
                        "Let conflicts emerge naturally and document them for resolution as they happen",
                        "Allow teams to work independently and address integration issues during final testing"
                    ],
                    correct: 0,
                    feedback: "Proactive communication and coordination between interdependent teams is essential for early conflict identification and successful project integration. Regular meetings facilitate this coordination."
                },
                {
                    id: "process_evm_001",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $120,000 budget should be 90% complete but is only 65% complete. The actual cost spent to date is $80,000. What are the Schedule Performance Index (SPI) and Cost Performance Index (CPI)?",
                    options: [
                        "SPI = 0.72, CPI = 0.98",
                        "SPI = 1.38, CPI = 1.20",
                        "SPI = 0.94, CPI = 1.04",
                        "SPI = 0.80, CPI = 0.91"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 65% √ó $120,000 = $78,000. Planned Value = 90% √ó $120,000 = $108,000. SPI = EV/PV = $78,000/$108,000 = 0.72. CPI = EV/AC = $78,000/$80,000 = 0.98. Both values below 1.0 indicate behind schedule and over budget."
                },
                {
                    id: "business_compliance_001",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "New regulatory requirements are expected in 6 months that will affect your product line. Your current project will complete in 3 months, but the product may not comply with the future regulations. How should you proceed?",
                    options: [
                        "Meet with stakeholders to assess risks, update assumptions, and potentially revise the project charter",
                        "Update the risk management plan and continue with current project planning",
                        "Complete the project quickly to avoid being subject to the new regulations",
                        "Recommend postponing the project until the new regulations are finalized"
                    ],
                    correct: 0,
                    feedback: "Regulatory changes represent significant project risks requiring immediate stakeholder consultation, risk assessment, and potential adjustments to scope or timeline to ensure compliance."
                }
                // Additional questions will be generated
            ],
            2: [ // Test Version B - Different questions testing same concepts
                {
                    id: "people_team_dev_002",
                    domain: "I.6",
                    domainName: "People",
                    question: "During project initiation, team members are getting acquainted and expressing enthusiasm, but they haven't received detailed project information yet. What team development stage is this?",
                    options: ["Storming", "Norming", "Forming", "Performing"],
                    correct: 2,
                    feedback: "The forming stage occurs when team members first meet and learn about the project. Members are typically polite, positive, and focused on understanding their roles and objectives."
                },
                {
                    id: "people_coordination_002",
                    domain: "I.6",
                    domainName: "People",
                    question: "Multiple teams are developing highly interdependent components. The team lead wants to prevent integration conflicts. What guidance should the project manager provide?",
                    options: [
                        "Schedule weekly coordination meetings to monitor progress and identify potential conflicts early",
                        "Sequence the teams' work to eliminate dependencies and potential conflicts",
                        "Create a conflict log to document issues as they arise during development",
                        "Plan to resolve all conflicts during the integration and testing phase"
                    ],
                    correct: 0,
                    feedback: "Early identification and prevention of conflicts through regular coordination is more effective than reactive conflict resolution. Proactive monitoring enables teams to adjust work before conflicts become critical."
                },
                {
                    id: "process_evm_002",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $110,000 budget should be 90% complete but is only 84% complete. The actual cost to date is $82,000. What are the SPI and CPI?",
                    options: [
                        "SPI = 0.93, CPI = 1.13",
                        "SPI = 1.07, CPI = 0.99",
                        "SPI = 1.15, CPI = 0.93",
                        "SPI = 0.96, CPI = 1.18"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 84% √ó $110,000 = $92,400. Planned Value = 90% √ó $110,000 = $99,000. SPI = $92,400/$99,000 = 0.93. CPI = $92,400/$82,000 = 1.13. SPI below 1.0 indicates schedule delays."
                },
                {
                    id: "business_compliance_002",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "After project charter approval, the team learns of new international compliance requirements that may impact the business case. What should the project manager do first?",
                    options: [
                        "Research the requirements thoroughly and provide recommendations to the sponsor",
                        "Update the quality management plan to address compliance requirements",
                        "Continue as planned since the requirement wasn't in the original scope",
                        "Add the requirement to the risk register and seek stakeholder guidance"
                    ],
                    correct: 0,
                    feedback: "The project manager should research and understand compliance requirements and their potential impact before recommending appropriate actions to the sponsor and stakeholders."
                }
                // Additional questions will be generated
            ],
            3: [ // Test Version C - Different questions testing same concepts
                {
                    id: "people_shared_understanding_001",
                    domain: "I.10",
                    domainName: "People",
                    question: "A newly formed team includes both employees and contractors. During the kickoff meeting, team members argue about project goals and requirements. What action will help build shared understanding?",
                    options: [
                        "Separate team members by expertise and assign specific work areas",
                        "Establish a hierarchical structure with clear authority levels",
                        "Have the product owner facilitate discussions and clarify project objectives",
                        "Pair employees with contractors for better knowledge transfer"
                    ],
                    correct: 2,
                    feedback: "When teams are in the storming phase with disagreements, having the product owner provide clarity on objectives and facilitate collaborative discussions helps move toward shared understanding."
                },
                {
                    id: "people_stakeholder_management_001",
                    domain: "I.6",
                    domainName: "People",
                    question: "A senior stakeholder bypasses the product owner and directly assigns urgent work to the agile team. The product owner becomes upset about this unauthorized work. How should the team address this?",
                    options: [
                        "Escalate to prevent the stakeholder from interfering with the team",
                        "Establish a working agreement between the stakeholder and product owner for handling urgent requests",
                        "Require the stakeholder to submit formal change requests for new work",
                        "Allow the stakeholder to add items directly to the product backlog"
                    ],
                    correct: 1,
                    feedback: "Creating a working agreement between the stakeholder and product owner establishes clear processes for handling urgent requests while maintaining proper agile governance."
                },
                {
                    id: "process_evm_003",
                    domain: "II.5",
                    domainName: "Process",
                    question: "A project with a $210,000 budget should be 70% complete but is only 55% complete. The actual cost spent is $162,000. What are the SPI and CPI?",
                    options: [
                        "SPI = 0.79, CPI = 0.71",
                        "SPI = 1.27, CPI = 0.98",
                        "SPI = 0.82, CPI = 1.05",
                        "SPI = 0.99, CPI = 0.96"
                    ],
                    correct: 0,
                    feedback: "Earned Value = 55% √ó $210,000 = $115,500. Planned Value = 70% √ó $210,000 = $147,000. SPI = $115,500/$147,000 = 0.79. CPI = $115,500/$162,000 = 0.71. Both indices below 1.0 indicate performance issues."
                },
                {
                    id: "business_patent_issue_001",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "The legal team discovers a competitor holds a patent for technology used in your nearly-complete product. What should the product owner do to determine the best path forward?",
                    options: [
                        "Research markets where the patent doesn't apply",
                        "Conduct economic analysis to identify minimum viable features for release",
                        "Immediately terminate the project to minimize losses",
                        "Continue development after removing the patented technology"
                    ],
                    correct: 1,
                    feedback: "When fundamental assumptions about product viability are challenged, economic analysis helps determine if there's a viable path forward and what minimum features could provide value while avoiding patent issues."
                }
                // Additional questions will be generated
            ]
        };

        // Generate additional questions for each test to reach 180 total
        function generateAdditionalQuestions() {
            // Sample question templates for different domains - all original content
            const additionalQuestions = [
                // People domain questions (42% - approximately 76 questions)
                {
                    id: "people_leadership_001",
                    domain: "I.2",
                    domainName: "People",
                    question: "A team member is struggling with new technology required for the project. What is the most appropriate leadership approach?",
                    options: ["Provide targeted training and mentoring support", "Reassign the team member to different tasks", "Hire an external consultant", "Document the skill gap as a project risk"],
                    correct: 0,
                    feedback: "Provide targeted training and mentoring support builds confidence and capability without disrupting team cohesion."
                }
            ];
            return additionalQuestions;
        }

        const TOTAL_QUESTIONS = 180;
        const DEFAULT_TIMER_SECONDS = 230 * 60;

        const state = {
            currentVersion: null,
            questions: [],
            currentIndex: 0,
            answers: [],
            submitted: [],
            timerEnabled: true,
            timerRemainingSeconds: DEFAULT_TIMER_SECONDS,
            timerInterval: null
        };

        function buildAdditionalQuestions(count, seedOffset = 0) {
            const templates = [
                {
                    id: "people_leadership",
                    domain: "I.2",
                    domainName: "People",
                    question: "A team member is struggling with a required skill. What should the project manager do first?",
                    options: [
                        "Provide coaching and targeted training",
                        "Reassign the team member immediately",
                        "Reduce the scope to avoid the skill gap",
                        "Escalate to the sponsor for a replacement"
                    ],
                    correct: 0,
                    feedback: "Coaching and training address the root cause while maintaining team engagement and project continuity."
                },
                {
                    id: "people_conflict",
                    domain: "I.6",
                    domainName: "People",
                    question: "Two team members disagree on the best approach to a task. What is the most effective action?",
                    options: [
                        "Facilitate a collaborative discussion to reach consensus",
                        "Choose the fastest approach and enforce it",
                        "Escalate to functional managers immediately",
                        "Separate the team members onto different tasks"
                    ],
                    correct: 0,
                    feedback: "Facilitating collaboration addresses the conflict and helps the team align on a shared approach."
                },
                {
                    id: "process_schedule",
                    domain: "II.2",
                    domainName: "Process",
                    question: "The schedule is at risk due to new scope changes. What should the project manager do?",
                    options: [
                        "Evaluate impacts and update the schedule baseline",
                        "Add resources without reassessing the plan",
                        "Ignore the changes to protect the timeline",
                        "Compress all remaining activities immediately"
                    ],
                    correct: 0,
                    feedback: "Scope changes require impact assessment and formal updates to the schedule baseline."
                },
                {
                    id: "process_change_control",
                    domain: "II.8",
                    domainName: "Process",
                    question: "A stakeholder requests a new feature mid-project. What is the correct first step?",
                    options: [
                        "Submit the request through the change control process",
                        "Add it to the backlog and start work",
                        "Reject it because the plan is finalized",
                        "Ask the sponsor to approve it informally"
                    ],
                    correct: 0,
                    feedback: "Formal change control ensures impacts are assessed and approvals are documented."
                },
                {
                    id: "business_compliance",
                    domain: "III.1",
                    domainName: "Business Environment",
                    question: "New regulations may affect a deliverable. What should the project manager do?",
                    options: [
                        "Assess the impact and update risks and assumptions",
                        "Continue as planned until regulations are final",
                        "Stop the project to avoid compliance risk",
                        "Defer the deliverable until after project close"
                    ],
                    correct: 0,
                    feedback: "Regulatory changes require immediate impact assessment and updates to project documentation."
                },
                {
                    id: "business_benefits",
                    domain: "III.2",
                    domainName: "Business Environment",
                    question: "The business case assumptions change significantly. What should the project manager do?",
                    options: [
                        "Re-evaluate the business case with stakeholders",
                        "Continue execution to avoid delays",
                        "Reduce quality to protect cost",
                        "Transfer ownership to operations"
                    ],
                    correct: 0,
                    feedback: "When assumptions change, the business case should be re-evaluated to confirm continued viability."
                }
            ];

            const generated = [];
            for (let i = 0; i < count; i += 1) {
                const template = templates[(i + seedOffset) % templates.length];
                generated.push({
                    ...template,
                    id: `${template.id}_${i + 1 + seedOffset}`
                });
            }
            return generated;
        }

        function buildQuestionSet(version) {
            const base = testQuestions[version] ? [...testQuestions[version]] : [];
            const needed = Math.max(0, TOTAL_QUESTIONS - base.length);
            return base.concat(buildAdditionalQuestions(needed, version * 1000));
        }

        function startTest(version) {
            state.currentVersion = version;
            state.questions = buildQuestionSet(version);
            state.currentIndex = 0;
            state.answers = new Array(state.questions.length).fill(null);
            state.submitted = new Array(state.questions.length).fill(false);
            state.timerEnabled = document.getElementById("timerEnabled").checked;

            document.getElementById("testSelection").style.display = "none";
            document.getElementById("results").classList.remove("show");
            document.getElementById("testInterface").style.display = "block";

            if (state.timerEnabled) {
                startTimer(DEFAULT_TIMER_SECONDS);
            } else {
                stopTimer();
                updateTimerDisplay(DEFAULT_TIMER_SECONDS);
            }

            renderQuestion();
        }

        function renderQuestion() {
            const question = state.questions[state.currentIndex];
            if (!question) {
                return;
            }

            document.getElementById("questionTitle").textContent = `Question ${state.currentIndex + 1}`;
            document.getElementById("questionProgress").textContent = `Question ${state.currentIndex + 1} of ${state.questions.length}`;
            document.getElementById("domainInfo").textContent = `Domain ${question.domain}: ${question.domainName}`;
            document.getElementById("questionText").textContent = question.question;

            const optionsContainer = document.getElementById("optionsContainer");
            optionsContainer.innerHTML = "";

            question.options.forEach((option, index) => {
                const optionItem = document.createElement("div");
                optionItem.className = "option-item";
                optionItem.dataset.index = index;
                optionItem.innerHTML = `
                    <span class="option-label">${String.fromCharCode(65 + index)}</span>
                    <span>${option}</span>
                `;
                optionItem.addEventListener("click", () => handleOptionSelect(index));
                optionsContainer.appendChild(optionItem);
            });

            updateAnswerUI();
            updateNavigation();
        }

        function handleOptionSelect(index) {
            state.answers[state.currentIndex] = index;
            updateAnswerUI();
            updateNavigation();
        }

        function updateAnswerUI() {
            const question = state.questions[state.currentIndex];
            const selectedIndex = state.answers[state.currentIndex];
            const immediateFeedbackEnabled = document.getElementById("immediateSubmitFeedback").checked;
            const isSubmitted = state.submitted[state.currentIndex];

            clearFeedback();
            resetOptionClasses();

            if (selectedIndex !== null) {
                applySelectedClass(selectedIndex);
            }

            if (isSubmitted) {
                showFeedback(question, selectedIndex);
                return;
            }

            if (immediateFeedbackEnabled && selectedIndex !== null && selectedIndex !== question.correct) {
                showFeedback(question, selectedIndex);
            }
        }

        function applySelectedClass(selectedIndex) {
            const options = document.querySelectorAll(".option-item");
            options.forEach((item, index) => {
                if (index === selectedIndex) {
                    item.classList.add("selected");
                }
            });
        }

        function resetOptionClasses() {
            const options = document.querySelectorAll(".option-item");
            options.forEach((item) => {
                item.classList.remove("selected", "correct", "incorrect");
            });
        }

        function showFeedback(question, selectedIndex) {
            const feedbackEl = document.getElementById("feedback");
            const feedbackText = document.getElementById("feedbackText");
            feedbackEl.classList.add("show");
            feedbackText.textContent = question.feedback;

            const options = document.querySelectorAll(".option-item");
            options.forEach((item, index) => {
                if (index === question.correct) {
                    item.classList.add("correct");
                }
                if (selectedIndex !== null && index === selectedIndex && selectedIndex !== question.correct) {
                    item.classList.add("incorrect");
                }
            });
        }

        function clearFeedback() {
            const feedbackEl = document.getElementById("feedback");
            feedbackEl.classList.remove("show");
        }

        function submitAnswer() {
            const selectedIndex = state.answers[state.currentIndex];
            if (selectedIndex === null) {
                return;
            }
            state.submitted[state.currentIndex] = true;
            updateAnswerUI();
            updateNavigation();
        }

        function nextQuestion() {
            if (!state.submitted[state.currentIndex]) {
                return;
            }
            if (state.currentIndex < state.questions.length - 1) {
                state.currentIndex += 1;
                renderQuestion();
            }
        }

        function previousQuestion() {
            if (state.currentIndex > 0) {
                state.currentIndex -= 1;
                renderQuestion();
            }
        }

        function updateNavigation() {
            const prevBtn = document.getElementById("prevBtn");
            const submitBtn = document.getElementById("submitBtn");
            const nextBtn = document.getElementById("nextBtn");
            const finishBtn = document.getElementById("finishBtn");

            const selectedIndex = state.answers[state.currentIndex];
            const isSubmitted = state.submitted[state.currentIndex];
            const isLastQuestion = state.currentIndex === state.questions.length - 1;

            prevBtn.disabled = state.currentIndex === 0;
            submitBtn.disabled = selectedIndex === null;
            nextBtn.disabled = !isSubmitted || isLastQuestion;

            if (isLastQuestion) {
                finishBtn.style.display = "inline-block";
                finishBtn.disabled = !isSubmitted;
            } else {
                finishBtn.style.display = "none";
            }
        }

        function finishTest() {
            stopTimer();
            showResults();
        }

        function showResults() {
            const totalQuestions = state.questions.length;
            let correctCount = 0;
            const domainStats = {};

            state.questions.forEach((question, index) => {
                const selected = state.answers[index];
                if (!domainStats[question.domainName]) {
                    domainStats[question.domainName] = { correct: 0, total: 0 };
                }
                domainStats[question.domainName].total += 1;
                if (selected !== null && selected === question.correct) {
                    correctCount += 1;
                    domainStats[question.domainName].correct += 1;
                }
            });

            const percentage = Math.round((correctCount / totalQuestions) * 100);
            document.getElementById("scoreNumber").textContent = correctCount.toString();
            document.getElementById("scorePercentage").textContent = `${percentage}%`;
            document.getElementById("correctCount").textContent = correctCount.toString();

            const domainResults = document.getElementById("domainResults");
            domainResults.innerHTML = "";

            let lowestDomain = null;
            let lowestPercentage = 101;

            Object.entries(domainStats).forEach(([domainName, stats]) => {
                const domainPercent = Math.round((stats.correct / stats.total) * 100);
                if (domainPercent < lowestPercentage) {
                    lowestPercentage = domainPercent;
                    lowestDomain = domainName;
                }

                const domainResult = document.createElement("div");
                domainResult.className = "domain-result";
                domainResult.innerHTML = `
                    <div>
                        <strong>${domainName}</strong>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${domainPercent}%"></div>
                        </div>
                    </div>
                    <div>${domainPercent}% (${stats.correct}/${stats.total})</div>
                `;
                domainResults.appendChild(domainResult);
            });

            const recommendationText = document.getElementById("recommendationText");
            if (lowestDomain) {
                recommendationText.textContent = `Focus additional study time on ${lowestDomain} concepts to raise your overall score.`;
            } else {
                recommendationText.textContent = "Great work! Review any incorrect questions to reinforce learning.";
            }

            document.getElementById("testInterface").style.display = "none";
            document.getElementById("results").classList.add("show");
        }

        function restartTest() {
            returnToHome();
        }

        function showTestOptions() {
            document.getElementById("testOptionsModal").style.display = "flex";
        }

        function hideTestOptions() {
            document.getElementById("testOptionsModal").style.display = "none";
        }

        function confirmResetTest() {
            hideTestOptions();
            document.getElementById("resetConfirmModal").style.display = "flex";
        }

        function hideResetConfirm() {
            document.getElementById("resetConfirmModal").style.display = "none";
        }

        function resetTest() {
            hideResetConfirm();
            returnToHome();
        }

        function returnToHome() {
            stopTimer();
            document.getElementById("testInterface").style.display = "none";
            document.getElementById("results").classList.remove("show");
            document.getElementById("testSelection").style.display = "block";
        }

        function startTimer(seconds) {
            stopTimer();
            state.timerRemainingSeconds = seconds;
            updateTimerDisplay(state.timerRemainingSeconds);
            state.timerInterval = setInterval(() => {
                state.timerRemainingSeconds -= 1;
                updateTimerDisplay(state.timerRemainingSeconds);
                if (state.timerRemainingSeconds <= 0) {
                    stopTimer();
                    finishTest();
                }
            }, 1000);
        }

        function stopTimer() {
            if (state.timerInterval) {
                clearInterval(state.timerInterval);
                state.timerInterval = null;
            }
        }

        function updateTimerDisplay(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            document.getElementById("timer").textContent = `${minutes}:${seconds.toString().padStart(2, "0")}`;
        }

        updateTimerDisplay(DEFAULT_TIMER_SECONDS);
    </script>
</body>
</html>
